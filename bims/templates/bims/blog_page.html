{% extends 'main_base.html' %}
{% load static from staticfiles %}
{% load wagtailcore_tags %}
{% load jsonify %}

{% block subtitle %}
    {{ self.title }}
{% endblock %}

{% block head %}

    <link href="{% static "css/fonts.css" %}" rel="stylesheet">
    <link href="{% static "css/clean-blog.css" %}" rel="stylesheet">
    <style>
        .blog-content {
            margin-bottom: 50px;
        }

        hr {
            max-width: 100%;
        }

    </style>
{% endblock %}

{% block body_content %}
    <!-- Page Header -->
    <header class="masthead">
        <div class="overlay"></div>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-md-10 mx-auto">
                    <div class="{% if self.get_ancestors.count > 1 %}post-heading{% else %}site-heading{% endif %}">
                        <h1>{{ self.title | safe }}</h1>
                        <span class="subheading">{{ self.intro | safe }}</span>
                        {% if self.get_ancestors.count > 1 %}
                            <span class="meta">Posted{% if self.owner %} by {{ self.owner.first_name }} {{ self.owner.last_name }}{% endif %} on {{ self.first_published_at }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container blog-content">
        <div class="row">
            <div class="col-lg-8 col-md-10 mx-auto">
                {% if self.get_ancestors.count > 1 %}
                    {{ page.body | richtext }}
                {% else %}
                    {% for page in posts %}
                        <div class="post-preview">
                            <a href="{% pageurl page %}">
                                <h2 class="post-title">{{ page.title }}</h2>
                                <h4 class="post-subtitle">
                                    {{ page.blogpage.intro | safe }}
                                </h4>
                            </a>
                            <p class="post-meta">
                                Posted{% if self.owner %} by {{ page.owner.first_name }} {{ page.owner.last_name }}{% endif %} on {{ page.first_published_at }}
                            </p>
                        </div>
                        <hr/>
                    {% endfor %}
                    <!-- Pager -->
                    <div class="clearfix">
                        {% if posts.has_next %}
                        <a class="btn btn-primary float-left" href="?page={{ posts.next_page_number }}">&larr; Older
                            Posts</a>
                        {% endif %}
                        {% if posts.has_previous %}
                        <a class="btn btn-primary float-right" href="?page={{ posts.previous_page_number }}">Newer
                            Posts &rarr;</a>
                        {% endif %}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}

{% block foot %}
    <!-- Plugin JavaScript -->
    <script src="{% static "js/libs/jquery/jquery-3.3.1.min.js" %}"></script>
    <script src="{% static "js/libs/bootstrap-4.0.0/js/bootstrap.min.js" %}"></script>
{% endblock %}
